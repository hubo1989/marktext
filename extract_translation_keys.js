const fs = require('fs');
const path = require('path');

// 从搜索结果中提取的所有翻译键
const translationKeys = [
  // 从第一次搜索结果中提取的键
  'preferences.selectFont',
  'menu.marktext.title',
  'contextMenu.changeLanguage',
  'common.ok',
  'editor.insertTable.title',
  'error.otherInstanceDetected',
  'preferences.editor.title',
  'dialog.save',
  'menu.help.help',
  'menu.format.format',
  'preferences.theme.title',
  'preferences.image.actions.upload',
  'import.title',
  'menu.edit.edit',
  'preferences.image.uploader.title',
  'preferences.image.uploader.services.none',
  'recent.noTabsOpen',
  'contextMenu.cut',
  'preferences.markdown.title',
  'preferences.image.folderSetting.title',
  'preferences.keybindings.title',
  'preferences.image.uploader.legalNotices.byUsing',
  'store.help.lineEndingAssertionError',
  'preferences.general.title',
  'preferences.markdown.misc.preferHeadingStyle.atx',
  'commandPalette.placeholder',
  'editor.sourceCode.cursorNullComment',
  'menu.paragraph.title',
  'preferences.image.title',
  'preferences.categories.general',
  'preferences.spellchecker.title',
  'commands.utils.todoUpdateCheck',
  'preferences.theme.autoSwitchOptions.startup',
  'preferences.title',
  'notifications.defaultTitle',
  'error.unexpectedMainProcess',
  'store.editor.anchorLinkCopied',
  'menu.window.title',
  
  // 从第二次搜索结果中提取的键
  'tweet.title',
  'notifications.defaultMessage',
  'preferences.theme.autoSwitchOptions.never',
  'preferences.keybindings.description',
  'preferences.keybindings.online',
  'preferences.keybindings.table.description',
  'preferences.keybindings.table.keyCombination',
  'preferences.keybindings.table.options',
  'preferences.keybindings.table.edit',
  'preferences.keybindings.table.reset',
  'preferences.keybindings.table.unbind',
  'preferences.keybindings.save',
  'preferences.keybindings.restoreDefaults',
  'preferences.keybindings.debugOptions',
  'preferences.keybindings.dumpKeyboardInfo',
  'preferences.keybindings.failedToSave',
  'preferences.keybindings.saveError',
  'preferences.keybindings.shortcutInUse',
  'preferences.keybindings.shortcutInUseMessage',
  'store.editor.tocItemNotFound',
  'store.editor.tabNotFound',
  'menu.help.markdownReference',
  'menu.help.changelog',
  'menu.help.askQuestion',
  'menu.help.reportBug',
  'menu.help.viewSource',
  'menu.help.license',
  'menu.help.checkUpdates',
  'menu.help.about',
  'recent.newFile',
  'search.searchPlaceholder',
  'search.searchResultCount',
  'search.caseSensitive',
  'search.wholeWord',
  'search.useRegex',
  'search.replacementPlaceholder',
  'search.replaceAll',
  'search.replaceSingle',
  'search.invalidRegex',
  'search.regexMatchEmpty',
  'menu.paragraph.heading1',
  'menu.paragraph.heading2',
  'menu.paragraph.heading3',
  'menu.paragraph.heading4',
  'menu.paragraph.heading5',
  'menu.paragraph.heading6',
  'menu.paragraph.promoteHeading',
  'menu.paragraph.demoteHeading',
  'menu.paragraph.table',
  'menu.paragraph.codeFences',
  'menu.paragraph.quoteBlock',
  'menu.paragraph.mathBlock',
  'menu.paragraph.htmlBlock',
  'menu.paragraph.orderedList',
  'menu.paragraph.bulletList',
  'menu.paragraph.taskList',
  'menu.paragraph.looseListItem',
  'menu.paragraph.paragraph',
  'menu.paragraph.horizontalRule',
  'menu.paragraph.frontMatter',
  'editor.insertTable.rows',
  'editor.insertTable.columns',
  'error.unexpectedRendererProcess',
  'error.terminatedDueToError',
  'error.copyError',
  'error.report',
  'error.unexpectedErrorWithMessage',
  'preferences.editor.textEditor.title',
  'preferences.editor.textEditor.fontSize',
  'preferences.editor.textEditor.lineHeight',
  'preferences.editor.textEditor.fontFamily',
  'preferences.editor.textEditor.maxWidth',
  'preferences.editor.textEditor.maxWidthNotes',
  'preferences.editor.codeBlock.title',
  'preferences.editor.codeBlock.fontSize',
  'preferences.editor.codeBlock.fontFamily',
  'preferences.editor.codeBlock.showLineNumbers',
  'preferences.editor.codeBlock.removeEmptyLines',
  'preferences.editor.writingBehavior.title',
  'preferences.editor.writingBehavior.autoCloseBrackets',
  'preferences.editor.writingBehavior.autoCompleteMarkdown',
  'preferences.editor.writingBehavior.autoCloseQuotes',
  'preferences.editor.fileRepresentation.title',
  'preferences.editor.fileRepresentation.tabWidth',
  'preferences.editor.fileRepresentation.lineSeparator',
  'preferences.editor.fileRepresentation.defaultEncoding',
  'preferences.editor.fileRepresentation.autoDetectEncoding',
  'preferences.editor.fileRepresentation.trailingNewlines',
  'preferences.editor.misc.title',
  'preferences.editor.misc.textDirection',
  'preferences.editor.misc.hideQuickInsertHint',
  'preferences.editor.misc.hideLinkPopup',
  'preferences.editor.misc.autoCheck',
  'preferences.editor.misc.wrapCodeBlocks',
  'error.configSchemaViolation',
  'error.initializationFailed',
  'error.startupError',
  'preferences.search.placeholder',
  'preferences.spellchecker.enableSpellChecking',
  'preferences.spellchecker.hideMarksForErrors',
  'preferences.spellchecker.autoDetectLanguage',
  'preferences.spellchecker.defaultLanguage',
  'preferences.spellchecker.autoDetectDescription',
  'preferences.spellchecker.customDictionary.title',
  'preferences.spellchecker.customDictionary.description',
  'preferences.spellchecker.customDictionary.noWordsAvailable',
  'preferences.spellchecker.customDictionary.word',
  'preferences.spellchecker.customDictionary.options',
  'preferences.spellchecker.customDictionary.delete',
  'spellchecker.failedToSwitchLanguage',
  'spellchecker.failedToRemoveWord',
  'spellchecker.unexpectedError',
  'dialog.dontSave',
  'dialog.cancel',
  'dialog.saveChanges',
  'dialog.file',
  'dialog.files',
  'dialog.changesWillBeLost',
  'dialog.importWarning',
  'dialog.installPandoc',
  'dialog.close',
  'dialog.keepOpen',
  'dialog.saveFailure',
  'dialog.replace',
  'dialog.fileExists',
  'preferences.general.window.titleBarStyle.custom',
  'preferences.general.window.titleBarStyle.native',
  'preferences.general.sidebar.fileSortBy.creationTime',
  'preferences.general.sidebar.fileSortBy.modificationTime',
  'preferences.general.sidebar.fileSortBy.title',
  'preferences.general.misc.language.english',
  'preferences.general.misc.language.chinese',
  'preferences.image.actions.folder',
  'preferences.image.actions.path',
  'preferences.general.autoSave.title',
  'preferences.general.autoSave.description',
  'preferences.general.autoSave.delayDescription',
  'preferences.general.window.title',
  'preferences.general.window.titleBarStyle',
  'preferences.general.window.requiresRestart',
  'preferences.general.window.hideScrollbars',
  'preferences.general.window.openFilesInNewWindow',
  'preferences.general.window.openFoldersInNewWindow',
  'preferences.general.window.zoom',
  'preferences.general.sidebar.title',
  'preferences.general.sidebar.wrapTextInToc',
  'preferences.general.sidebar.excludePatterns',
  'preferences.general.sidebar.excludePatternsNotes',
  'preferences.general.sidebar.fileSortBy',
  'preferences.general.startup.title',
  'preferences.general.startup.openDefaultDirectory',
  'preferences.general.startup.selectFolder',
  'preferences.general.startup.openBlankPage',
  'preferences.general.misc.title',
  'preferences.general.misc.language.title',
  'import.description',
  'menu.file.file',
  'menu.file.newTab',
  'menu.file.newWindow',
  'menu.file.openFile',
  'menu.file.openFolder',
  'menu.file.openRecent',
  'menu.file.clearRecentlyUsed',
  'menu.file.save',
  'menu.file.saveAs',
  'menu.file.autoSave',
  'menu.file.moveTo',
  'menu.file.rename',
  'menu.file.import',
  'menu.file.export',
  'menu.file.exportHtml',
  'menu.file.exportPdf',
  'menu.file.print',
  'menu.file.preferences',
  'menu.file.closeTab',
  'menu.file.closeWindow',
  'menu.file.quit',
  'about.copyright',
  'about.copyrightContributors',
  'preferences.keybindings.keyInputDialog.instructions',
  'preferences.keybindings.keyInputDialog.invalidKeybinding',
  'preferences.keybindings.keyInputDialog.placeholder',
  'contextMenu.addToDictionary',
  'contextMenu.editDictionary',
  'menu.edit.undo',
  'menu.edit.redo',
  'menu.edit.cut',
  'menu.edit.copy',
  'menu.edit.paste',
  'menu.edit.copyAsMarkdown',
  'menu.edit.copyAsHtml',
  'menu.edit.pasteAsPlainText',
  'menu.edit.selectAll',
  'menu.edit.duplicate',
  'menu.edit.createParagraph',
  'menu.edit.deleteParagraph',
  'menu.edit.find',
  'menu.edit.findNext',
  'menu.edit.findPrevious',
  'menu.edit.replace',
  'menu.edit.findInFolder',
  'menu.edit.screenshot',
  'menu.edit.lineEnding',
  'menu.edit.lineEndingCrlf',
  'menu.edit.lineEndingLf',
  'menu.format.bold',
  'menu.format.italic',
  'menu.format.underline',
  'menu.format.superscript',
  'menu.format.subscript',
  'menu.format.highlight',
  'menu.format.inlineCode',
  'menu.format.inlineMath',
  'menu.format.strikethrough',
  'menu.format.hyperlink',
  'menu.format.image',
  'menu.format.clearFormat',
  'menu.window.minimize',
  'menu.window.alwaysOnTop',
  'menu.window.zoomIn',
  'menu.window.zoomOut',
  'menu.window.fullScreen',
  'menu.window.bringAllToFront',
  'preferences.image.uploader.legalNotices.privacyStatement',
  'preferences.image.uploader.legalNotices.and',
  'preferences.image.uploader.legalNotices.termsOfService',
  'preferences.image.uploader.legalNotices.gdprWarning',
  'preferences.image.defaultAction',
  'preferences.image.clipboardTooltip',
  'preferences.image.uploader.services.picgo',
  'preferences.image.uploader.services.github',
  'preferences.image.uploader.services.cliScript',
  'preferences.image.uploader.currentUploader',
  'preferences.image.uploader.noUploaderSelected',
  'preferences.image.uploader.picgoNotInstalled',
  'preferences.image.uploader.pleaseInstall',
  'preferences.image.uploader.githubDeprecated',
  'preferences.image.uploader.githubToken',
  'preferences.image.uploader.tokenTooltip',
  'preferences.image.uploader.inputToken',
  'preferences.image.uploader.ownerName',
  'preferences.image.uploader.owner',
  'preferences.image.uploader.repoName',
  'preferences.image.uploader.repo',
  'preferences.image.uploader.branchName',
  'preferences.image.uploader.branch',
  'preferences.image.uploader.save',
  'preferences.image.uploader.scriptDescription',
  'preferences.image.uploader.scriptLocation',
  'preferences.image.uploader.scriptPath',
  'preferences.image.uploader.saveConfig',
  'preferences.image.uploader.githubConfigSaved',
  'preferences.image.uploader.scriptConfigSaved',
  'preferences.editor.fileRepresentation.endOfLine.default',
  'preferences.editor.fileRepresentation.endOfLine.crlf',
  'preferences.editor.fileRepresentation.endOfLine.lf',
  'preferences.editor.fileRepresentation.trailingNewlines.trimAll',
  'preferences.editor.fileRepresentation.trailingNewlines.ensureOne',
  'preferences.editor.fileRepresentation.trailingNewlines.preserve',
  'preferences.editor.fileRepresentation.trailingNewlines.doNothing',
  'preferences.editor.misc.textDirection.ltr',
  'preferences.editor.misc.textDirection.rtl',
  'preferences.categories.editor',
  'preferences.categories.markdown',
  'preferences.categories.spelling',
  'preferences.categories.theme',
  'preferences.categories.image',
  'preferences.categories.keybindings',
  'editor.sourceCode.imageStructureDeletedComment',
  'preferences.theme.autoSwitch',
  'preferences.theme.customCss',
  'preferences.theme.openThemesFolder',
  'preferences.theme.openFolder',
  'preferences.theme.importCustomThemes',
  'preferences.theme.importTheme',
  'preferences.image.folderSetting.globalFolder',
  'preferences.image.folderSetting.open',
  'preferences.image.folderSetting.showInFolder',
  'preferences.image.folderSetting.preferRelative',
  'preferences.image.folderSetting.relativeFolderName',
  'preferences.image.folderSetting.filenameNote',
  'commands.utils.noUpdateResourceFile',
  'contextMenu.spelling',
  'menu.marktext.about',
  'menu.marktext.checkUpdates',
  'menu.marktext.preferences',
  'menu.marktext.services',
  'menu.marktext.hide',
  'menu.marktext.hideOthers',
  'menu.marktext.showAll',
  'menu.marktext.quit',
  'contextMenu.copy',
  'contextMenu.paste',
  'contextMenu.pasteAsPlainText',
  'contextMenu.insertParagraphBefore',
  'contextMenu.insertParagraphAfter',
  'preferences.markdown.lists.title',
  'preferences.markdown.lists.preferLooseListItem',
  'preferences.markdown.lists.bulletListMarker',
  'preferences.markdown.lists.orderListDelimiter',
  'preferences.markdown.lists.listIndentation',
  'preferences.markdown.extensions.title',
  'preferences.markdown.extensions.frontmatterType',
  'preferences.markdown.extensions.superSubScript',
  'preferences.markdown.extensions.footnote',
  'preferences.markdown.extensions.footnoteNotes',
  'preferences.markdown.compatibility.title',
  'preferences.markdown.compatibility.enableHtml',
  'preferences.markdown.compatibility.enableGitlab',
  'preferences.markdown.diagrams.title',
  'preferences.markdown.diagrams.sequenceTheme',
  'preferences.markdown.misc.title',
  'preferences.markdown.misc.preferHeadingStyle',
  'commandPalette.commandNotFound',
  'editor.notifications.notificationNotFound',
  'preferences.markdown.misc.preferHeadingStyle.setext',
  'preferences.markdown.lists.listIndentation.dfm',
  'preferences.markdown.lists.listIndentation.tab',
  'preferences.markdown.lists.listIndentation.oneSpace',
  'preferences.markdown.lists.listIndentation.twoSpaces',
  'preferences.markdown.lists.listIndentation.threeSpaces',
  'preferences.markdown.lists.listIndentation.fourSpaces',
  'preferences.markdown.extensions.frontmatterType.jsonSemicolon',
  'preferences.markdown.extensions.frontmatterType.jsonBrace',
  'preferences.markdown.diagrams.sequenceTheme.handDrawn',
  'preferences.markdown.diagrams.sequenceTheme.simple'
];

// 将翻译键转换为嵌套对象结构
function createNestedObject(keys) {
  const result = {};
  
  keys.forEach(key => {
    const parts = key.split('.');
    let current = result;
    
    for (let i = 0; i < parts.length; i++) {
      const part = parts[i];
      if (i === parts.length - 1) {
        // 最后一个部分，设置为 true 表示这个键存在
        current[part] = true;
      } else {
        // 中间部分，创建嵌套对象
        if (!current[part]) {
          current[part] = {};
        }
        current = current[part];
      }
    }
  });
  
  return result;
}

// 生成嵌套的翻译键结构
const nestedKeys = createNestedObject(translationKeys);

// 写入文件
fs.writeFileSync(
  path.join(__dirname, 'extracted_translation_keys.json'),
  JSON.stringify(nestedKeys, null, 2),
  'utf8'
);

console.log('翻译键已提取并保存到 extracted_translation_keys.json');
console.log(`总共提取了 ${translationKeys.length} 个翻译键`);

// 同时生成一个扁平的键列表用于比对
fs.writeFileSync(
  path.join(__dirname, 'extracted_translation_keys_flat.json'),
  JSON.stringify(translationKeys.sort(), null, 2),
  'utf8'
);

console.log('扁平的翻译键列表已保存到 extracted_translation_keys_flat.json');